<!DOCTYPE html>
<html>
<head>
    <title>Customer Management - Loan System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="/css/customer.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar (reuse from dashboard) -->
        <div class="sidebar">
            <!-- ... sidebar content ... -->
        </div>

        <div class="main-content">
            <div class="customer-container">
                <!-- Page Header -->
                <div class="page-header">
                    <h1 class="page-title">Customer Management</h1>
                    <button class="btn-add-customer" onclick="openAddCustomerModal()">
                        <i class="fas fa-plus"></i> Add New Customer
                    </button>
                </div>

                <!-- Search and Filter Section -->
                <div class="search-filter-container">
                    <div class="search-box">
                        <input 
                            type="text" 
                            class="search-input" 
                            placeholder="Search customers..."
                        >
                        <button class="btn-add-customer">
                            <i class="fas fa-search"></i> Search
                        </button>
                    </div>
                    <div class="filter-options">
                        <select class="filter-select">
                            <option value="">Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                        <select class="filter-select">
                            <option value="">Sort By</option>
                            <option value="name">Name</option>
                            <option value="date">Date Added</option>
                            <option value="loans">Number of Loans</option>
                        </select>
                    </div>
                </div>

                <!-- Customer Table -->
                <div class="customer-table-container">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>Customer ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Total Loans</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>CUS001</td>
                                <td>John Doe</td>
                                <td>john@example.com</td>
                                <td>+1234567890</td>
                                <td>3</td>
                                <td><span class="status-badge status-active">Active</span></td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action btn-view" onclick="viewCustomer('CUS001')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn-action btn-edit" onclick="editCustomer('CUS001')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="btn-action btn-delete" onclick="deleteCustomer('CUS001')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <!-- Add more customer rows here -->
                        </tbody>
                    </table>

                    <!-- Pagination -->
                    <div class="pagination">
                        <button><i class="fas fa-chevron-left"></i></button>
                        <button class="active">1</button>
                        <button>2</button>
                        <button>3</button>
                        <button><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Customer Modal -->
    <div class="modal" id="customerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Customer</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <form id="customerForm" onsubmit="handleCustomerSubmit(event)">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="address">Address</label>
                    <input type="text" id="address" name="address" required>
                </div>
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status" required>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-action" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn-add-customer">Save Customer</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Modal functions
        function openAddCustomerModal() {
            const modal = document.getElementById('customerModal');
            if (modal) {
                // Reset form
                document.getElementById('customerForm').reset();
                // Clear image previews
                document.getElementById('frontPreview').style.backgroundImage = '';
                document.getElementById('backPreview').style.backgroundImage = '';
                document.getElementById('frontPreview').innerHTML = '<i class="fas fa-plus"></i><span>Upload Image</span>';
                document.getElementById('backPreview').innerHTML = '<i class="fas fa-plus"></i><span>Upload Image</span>';
                // Show modal
                modal.classList.add('show');
            }
        }

        function closeModal() {
            document.getElementById('customerModal').classList.remove('show');
        }

        function editCustomer(customerId) {
            document.getElementById('modalTitle').textContent = 'Edit Customer';
            document.getElementById('customerModal').classList.add('show');
            // Add logic to populate form with customer data
        }

        function viewCustomer(customerId) {
            // Add logic to view customer details
        }

        function deleteCustomer(customerId) {
            if (confirm('Are you sure you want to delete this customer?')) {
                // Add delete logic here
            }
        }

        function handleCustomerSubmit(event) {
            event.preventDefault();
            // Add form submission logic here
            closeModal();
        }

        function previewImage(input, previewId) {
            const preview = document.getElementById(previewId);
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.style.backgroundImage = `url(${e.target.result})`;
                    preview.innerHTML = ''; // Clear the upload icon and text
                }
                reader.readAsDataURL(file);
            }
        }

        function handleCustomerSubmit(event) {
            event.preventDefault();
            // Create FormData object to handle file uploads
            const formData = new FormData(event.target);
            // You can send this to your server using fetch
            fetch('/api/customers', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    closeModal();
                    // Refresh customer list or show success message
                    alert('Customer added successfully!');
                } else {
                    alert('Error adding customer: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error adding customer');
            });
        }

        function validateForm() {
            // Add custom validation if needed
            const form = document.getElementById('customerForm');
            const inputs = form.querySelectorAll('input[required]');
            let isValid = true;
            inputs.forEach(input => {
                if (!input.value) {
                    isValid = false;
                    input.classList.add('error');
                } else {
                    input.classList.remove('error');
                }
            });
            return isValid;
        }
    </script>
</body>
</html> 